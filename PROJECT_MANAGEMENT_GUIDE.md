# GBRS Project Management Guide

This guide explains how to add, edit, and manage projects now that the system has been refactored to use **Astro Content Collections**. This setup separates the content (data) from the code, making it easy to manage and ready for a CMS integration.

---

## 1. Overview
Previously, project information was hardcoded into the HTML files. Now, every project lives as an individual file in a specific folder. Astro reads these files and automatically builds the "Projects" page, "Featured Projects" sections, and individual Service page examples.

**Key Locations:**
*   **Project Files:** `src/content/projects/` (Where you add/edit content)
*   **Configuration:** `src/content/config.ts` (Defines the allowed fields)
*   **Images:** `src/assets/photos/` (Where images are stored for optimization)

---

## 2. How to Add a New Project

To add a new project, you simply create a new text file.

1.  **Navigate** to `src/content/projects/`.
2.  **Create a new file** ending in `.md`. The filename should be URL-friendly (e.g., `new-grain-store.md`).
3.  **Add the Frontmatter**. This is the configuration block at the top of the file between the `---` dashes.

**Template:**
```markdown
---
title: "New Grain Store Extension"
category: "agricultural"
description: "A brief 1-2 sentence description of the project that appears on the card."
thumbnail: "../../assets/photos/path/to/your/thumbnail.jpg"
gallery:
  - "../../assets/photos/path/to/image1.jpg"
  - "../../assets/photos/path/to/image2.jpg"
  - "../../assets/photos/path/to/image3.jpg"
featured: false
order: 10
---
```

### Field Reference

| Field | Type | Options / Description |
| :--- | :--- | :--- |
| `title` | Text | The main header of the project card. |
| `category` | Text | Must be exactly one of: `agricultural`, `industrial`, `recladding`, `groundworks`, `new-build`. |
| `description` | Text | Short summary displayed on the card. |
| `thumbnail` | Path | Path to the main image shown on the grid (must be relative to the .md file, e.g. `../../assets/photos/...`). |
| `gallery` | List | List of image paths for the pop-up gallery. Leave empty `[]` if no gallery. |
| `featured` | Boolean | `true` = Show on Homepage/Featured section. `false` = Only show on Projects page. |
| `order` | Number | Controls sorting order (Lower numbers appear first). |

---

## 3. Managing Images

The system now uses Astro's Image optimization. Images are stored in `src/assets/photos/`.

*   **Pathing:** When referencing an image in your `.md` file, you must use a **relative path** from the markdown file to the image file.
    *   Since markdown files are in `src/content/projects/` and images are in `src/assets/photos/`, the path usually starts with:
    *   `../../assets/photos/Folder/Image.jpg`

This ensures Astro can optimize the images (resize, format conversion) during the build process.

**Why `src/assets` and not `public/`?**
*   **Optimization:** Images in `src/assets` are processed by Astro. They are automatically resized, compressed, and converted to modern formats like WebP. This significantly improves page load speeds.
*   **Validation:** The build will fail if an image path is incorrect, preventing broken images on the live site.
*   **CMS Compatibility:** This setup is fully compatible with Decap CMS by configuring the `media_folder` to `src/assets/photos` and `public_folder` to a relative path.

---

## 4. How It Works (Technical)

### The Project Card (`src/components/ProjectCard.astro`)
This is the core component used to display projects across the site.
*   **Usage:** It takes a `project` object (from the content collection) as a prop.
*   **Features:** It handles the image optimization, badge display, and the "View Gallery" button logic internally.
*   **Slots:** It includes a `<slot />` which allows pages (like the Service pages) to inject custom content (e.g., "Project Highlights" lists) into the card without modifying the component itself.

### The Projects Page (`src/pages/projects.astro`)
This page automatically fetches every file inside `src/content/projects/`.
1.  It runs `getCollection('projects')`.
2.  It loops through the results and renders a `<ProjectCard />` for each one.
3.  It includes inline script logic for filtering and pagination.

### The Gallery Modal (`src/components/ProjectModal.astro`)
The modal logic is now self-contained within this component.
*   **Mechanism:** The "View Gallery" button generated by `ProjectCard` contains resolved image URLs in `data-gallery`.
*   **Result:** Clicking "View Gallery" opens the modal without needing global scripts.

---

## 5. Future CMS Integration (Decap CMS)

To use Decap CMS with this setup:
1.  Configure the CMS to output images to `src/assets/photos`.
2.  Configure the CMS to use relative paths for the image widget.
