---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import ProjectCard from '../../components/ProjectCard.astro';
import PageHero from '../../components/PageHero.astro';

// Dynamically get all groundworks projects
const allGroundworksProjects = await getCollection('projects', ({ data }) => {
  return data.category === 'groundworks';
});

// Sort by order
const sortedProjects = allGroundworksProjects.sort((a, b) => a.data.order - b.data.order);
---

<Layout 
  title="Groundworks Projects | GBRS Services"
  description="Groundworks and civil engineering projects by GBRS Services Hartlepool. Foundations, drainage, and site preparation."
  activePage="services"
>
  <PageHero 
    title="Groundworks & Foundations"
    subtitle="Solid foundations for every construction project"
  >
    <div style="margin-top: 20px;">
      <a href="/services" class="btn-secondary" style="background: rgba(255,255,255,0.2); border-color: white;">‚Üê Back to Services</a>
    </div>
  </PageHero>

  <section class="projects section">
    <div class="container">
      <div class="section-header">
        <h2>Groundworks Projects</h2>
      </div>
      <p class="projects-intro">
        View our completed groundworks and foundation projects across the North East. We provide essential groundwork services from site preparation to concrete foundations.
      </p>
      
      <div class="projects-grid-enhanced">
        {sortedProjects.map(project => (
          <ProjectCard project={project} />
        ))}

        {sortedProjects.length === 0 && (
          <div class="project-card" style="grid-column: 1 / -1; background: var(--light-grey); text-align: center; padding: 60px 20px;">
            <h3 style="margin-bottom: 15px; color: #333;">Projects Coming Soon</h3>
            <p style="margin-bottom: 25px; color: #666;">We're currently uploading our groundworks projects. Check back soon or contact us to discuss your requirements.</p>
            <a href="/#contact" class="btn-primary">Get a Free Quote</a>
          </div>
        )}

        {sortedProjects.length > 0 && (
          <div class="project-card" style="grid-column: 1 / -1; background: var(--light-grey); text-align: center; padding: 60px 20px;">
            <h3 style="margin-bottom: 15px; color: #333;">More Projects Coming Soon</h3>
            <p style="margin-bottom: 25px; color: #666;">We're currently updating our portfolio with 120+ completed projects. Check back soon or contact us to discuss your requirements.</p>
            <a href="/#contact" class="btn-primary">Get a Free Quote</a>
          </div>
        )}
      </div>
    </div>
  </section>
</Layout>
