---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import ProjectCard from '../../components/ProjectCard.astro';
import PageHero from '../../components/PageHero.astro';

// Dynamically get all agricultural projects
const allAgriculturalProjects = await getCollection('projects', ({ data }) => {
  return data.category === 'agricultural';
});

// Sort by order
const sortedProjects = allAgriculturalProjects.sort((a, b) => a.data.order - b.data.order);
---

<Layout 
  title="Agricultural Buildings Projects | GBRS Services"
  description="Agricultural building projects by GBRS Services Hartlepool. View our completed grain stores, barns, livestock housing, and agricultural structures."
  activePage="services"
>
  <PageHero 
    title="Agricultural Buildings" 
    subtitle="Custom steel-framed structures for modern farming"
  >
     <div style="margin-top: 20px;">
        <a href="/services" class="btn-secondary" style="background: rgba(255,255,255,0.2); border-color: white;">‚Üê Back to Services</a>
      </div>
  </PageHero>

  <section class="projects section">
    <div class="container">
      <div class="section-header">
        <h2>Agricultural Projects</h2>
      </div>
      <p class="projects-intro">
        View our completed agricultural building projects across the North East. From grain stores to livestock housing, 
        we deliver functional, durable structures tailored to your farming needs.
      </p>
      
      <div class="projects-grid-enhanced">
        {sortedProjects.map(project => (
          <ProjectCard project={project} />
        ))}

        {sortedProjects.length === 0 && (
          <div class="project-card" style="grid-column: 1 / -1; background: var(--light-grey); text-align: center; padding: 60px 20px;">
            <h3 style="margin-bottom: 15px; color: #333;">Projects Coming Soon</h3>
            <p style="margin-bottom: 25px; color: #666;">We're currently uploading our agricultural building projects. Check back soon or contact us to discuss your requirements.</p>
            <a href="/#contact" class="btn-primary">Get a Free Quote</a>
          </div>
        )}

        {sortedProjects.length > 0 && (
          <div class="project-card" style="grid-column: 1 / -1; background: var(--light-grey); text-align: center; padding: 60px 20px;">
            <h3 style="margin-bottom: 15px; color: #333;">More Projects Coming Soon</h3>
            <p style="margin-bottom: 25px; color: #666;">We're currently updating our portfolio with 120+ completed projects. Check back soon or contact us to discuss your requirements.</p>
            <a href="/#contact" class="btn-primary">Get a Free Quote</a>
          </div>
        )}
      </div>
    </div>
  </section>
</Layout>
