---
import { getCollection } from 'astro:content';
import ProjectCard from './ProjectCard.astro';

const allProjects = await getCollection('projects');
const featuredProjects = allProjects
  .filter(p => p.data.featured)
  .sort((a, b) => a.data.order - b.data.order)
  .slice(0, 4); // Cap at 4 featured projects
---

<section id="projects" class="projects section">
  <div class="container">
    <div class="section-header">
      <span class="section-tag">Our Work</span>
      <h2>Featured Projects</h2>
    </div>
    <p class="projects-intro">
      See our latest completed projects across Hartlepool and the North East. 
    </p>
    
    <div class="projects-grid-enhanced">
      {featuredProjects.map(project => (
        <ProjectCard project={project} />
      ))}
    </div>

    <div class="projects-cta">
      <p>View our complete portfolio of 120+ completed projects</p>
      <a href="/projects" class="btn-primary">Browse All Projects</a>
    </div>
  </div>
</section>

<style>
.projects{background:var(--light-grey);} 
.projects h2{text-align:center;margin-bottom:15px;font-size:2rem;} 
@media(min-width:768px){.projects h2{font-size:2.5rem;}} 
.projects-intro{text-align:center;max-width:800px;margin:0 auto 50px;font-size:1.1rem;color:#555;} 
.projects-grid-enhanced{display:grid;grid-template-columns:1fr;gap:40px;max-width:1200px;margin:0 auto 50px;} 
@media(min-width:768px){.projects-grid-enhanced{grid-template-columns:repeat(2,1fr);}} 
@media(min-width:1024px){.projects-grid-enhanced{grid-template-columns:repeat(3,1fr);}} 
.projects-cta{text-align:center;padding:40px 20px;background:white;border-radius:12px;margin-top:50px;} 
.projects-cta p{font-size:1.3rem;font-weight:600;color:#333;margin-bottom:20px;} 
</style>
